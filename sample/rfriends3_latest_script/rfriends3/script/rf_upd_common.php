<?php
 function phpzip() { $flg =0; $mo = get_loaded_extensions(); foreach ($mo as $v) { if ($v == "zip") { break; } } if ($v != "zip") { $flg =1; } if ($flg == 1) { echo_msg(2, "ツール(zip)を更新します....."); rfmenu_update_sys(); echo_msg(2, "更新完了"); echo_msg(2, ""); echo_msg(2, "一旦終了します。"); } return ($flg); } function rf_update_unzip($fl, $dir, $pn, $flg) { global $DS; global $cmd_which; if ($flg == 1) { $dst = $dir."_test".$DS; } else { $dst = $dir; } $ret = rf_extract($fl,$dst,$pn); if ($ret === true) return $ret; if ($pn == "") return $ret; $ret = exec("$cmd_which 7z"); if ($ret === false) return $ret; $ret = rfgw_extract_7z($fl, $dir, $pn); return $ret; } function rf_get_down_url($no,$ty) { global $scrdir; global $DS; $str = file($scrdir."update"); if ($str === false) { return false; } $n = count_73($str) - 1; if (($no < 0) || ($no > $n)) { $url = $str[0]; } else { $url = $str[$no]; } $url = trim($url); if (substr($url,-1) != "/") { $url .= "/"; } return($url); } function rm_dir($dr) { if (!is_dir($dr)) { return; } foreach (glob($dr . '/*') as $fl) { if (is_dir($fl)) { rm_dir($fl); } else { unlink($fl); } } rmdir($dr); } 